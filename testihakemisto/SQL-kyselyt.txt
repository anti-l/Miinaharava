Er? 4: SQL-yhteenvetokyselyt
Y01:
Hae j?rjestelm??n kuuluvien suomalaisten hotellien lukum??r?. Anna vastaus sarakkeessa HOTELS.

SELECT COUNT(countrycode) AS "HOTELS"
FROM HTLHotel
WHERE countrycode='FI'




Y02:
Laadi kysely, jolla selvit?t huonetyyppikuvausten perusteella Turussa tarjolla olevien hotellihuoneiden kokonaism??r?n. Anna vastaus sarakkeessa ROOMS_IN_TURKU.

SELECT SUM(numberofrooms) AS "ROOMS_IN_TURKU"
FROM HTLRoomType, HTLHotel
WHERE HTLRoomType.HotelID='TURKAMA'
AND HTLRoomType.HotelID=HTLHotel.HotelID
AND HTLHotel.City='Turku'




Y03:
Tee kysely, jolla selvit?t mik? hotelli on t?htiluokituksen perusteella paras. Anna tuloksena hotellin tunnus, nimi, kaupunki sek? t?htien lukum??r?.

SELECT HotelID, HotelName, City, Stars
FROM HTLHotel
WHERE Stars >= all
(SELECT STARS from HTLHOTEL)





Y04:
Kuinka monessa maassa asuvia asiakkaita on varaajarekisteriss?? Anna vastaus sarakkeessa COUNTRIES.

SELECT COUNT(DISTINCT Home_Country) AS "COUNTRIES"
FROM HTLCustomer



Y05:
Laske varausten perusteella mik? on hotellivierailun keskim??r?inen ja maksipituus yhden desimaalin tarkkudella Turun Kamari hotellissa (tunnus TURKAMA). Anna arvot sarakkeissa AVG_STAY ja MAX_STAY. Vihje: Py?ristys round-funktiolla.

SELECT ROUND(AVG(DepartureDate-ArrivalDate),1) as "AVG_STAY", MAX(DepartureDate-ArrivalDate) "MAX_STAY"
FROM HTLBooking
WHERE HotelID='TURKAMA'


Y06:
Selvit? mik? on on halvimman ja kalleimman huoneen hinnanero Tallinnan Maja hotellissa (id TALMAJA) yhdeksi vuorokaudeksi 29.9.2013 kahdelle hengelle aamiaisineen. Anna ero sarakkeessa DIFF. (Huom: hotellilla on useita hinnoitteluj?rjestelmi?. VIHJE: funktiolla to_char(x,'d') saat selville p?iv?yksen x viikonp?iv?n numeron)


TALMAJA NOBR..
halvin 60+2x8=76
kallein 90+2x8=106
TALMAJA OF01..
halvin 65 (Vain viikonloppuisin! Arkipäivinä 10e kalliimpi)
kallein 95




SELECT MAX(Normalprice+2*BreakfastFee) - MIN(Normalprice+2*BreakfastFee) DIFF
FROM HTLRoomPrice, HTLPriceCategory, HTLRoomType
WHERE HTLRoomPrice.PriceCategoryID=HTLPriceCategory.PriceCategoryID
AND HTLRoomPrice.HotelID='TALMAJA'
AND to_char(date '2013-09-29','d') BETWEEN FirstDay and LastDay







Y07:
Selvitä Turun Kamari hotellin (tunnus TURKAMA) huoneiden käyttöaste prosentteina 6.9.2013 ja 7.9.2013 välisenä yönä. Anna tulos sarakkeessa OCCUPIED. Laske huoneiden lukumäärä taulun HTLROOM perusteella. 


SELECT 100*Kaytossa/Kaikki as OCCUPIED
FROM 
    (SELECT COUNT(*) Kaytossa 
	FROM HTLVisit, HTLVisitDate
	WHERE DateVisited = date '2013-09-06'
	AND HTLVisit.HotelID='TURKAMA'
	AND HTLVisit.VisitID=HTLVisitDate.VisitID),
    (SELECT COUNT(*) Kaikki
	FROM HTLROOM
	WHERE HotelID='TURKAMA')



SELECT COUNT(*) Kaytossa 
FROM HTLVisit, HTLVisitDate
WHERE DateVisited = date '2013-09-06'
AND HTLVisit.HotelID='TURKAMA'
AND HTLVisit.VisitID=HTLVisitDate.VisitID

































